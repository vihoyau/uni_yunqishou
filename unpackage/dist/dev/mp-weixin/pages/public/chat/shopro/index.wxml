<view class="chat-wrap"><u-navbar vue-id="0dc13a66-1" borderBottom="{{true}}" background="{{navBackground}}" back-icon-color="#fff" bind:__l="__l" vue-slots="{{['default']}}"><view class="u-flex u-col-bottom head-box"><view class="head-title u-m-r-20">{{$root.g0[0]}}</view><view hidden="{{!($root.g1[1]==='在线')}}" class="u-flex u-col-center"><view class="iconfont iconyuandianxiao text-green head-icon"></view><view class="head-state">在线</view></view><view hidden="{{!($root.g2[1]==='离线')}}" class="u-flex u-col-center"><view class="iconfont iconyuandianxiao text-gray head-icon"></view><view class="head-state">离线</view></view></view></u-navbar><u-notice-bar vue-id="0dc13a66-2" autoplay="{{true}}" close-icon="{{true}}" show="{{showNotice}}" type="{{noticeType}}" list="{{noticeList}}" volumeIcon="{{true}}" isCircular="{{true}}" data-event-opts="{{[['^close',[['closeNotice']]]]}}" bind:close="__e" bind:__l="__l"></u-notice-bar><scroll-view class="scroll-box" scroll-y="true" scroll-with-animation="{{false}}" enable-back-to-top="{{true}}" show-scrollbar="{{false}}" scroll-into-view="{{scrollInto}}"><block wx:if="{{logmsgList.length}}"><u-loadmore vue-id="0dc13a66-3" status="{{logStatus}}" loadText="{{loadText}}" icon-type="circle" data-event-opts="{{[['^loadmore',[['logLoadmore']]]]}}" bind:loadmore="__e" bind:__l="__l"></u-loadmore></block><view class="cu-chat"><block wx:for="{{$root.l0}}" wx:for-item="chat" wx:for-index="index" wx:key="index"><block><block wx:if="{{chat.$orig.type==='system'}}"><view class="cu-info">{{chat.$orig.msg}}</view></block><block wx:if="{{chat.m0&&chat.$orig.type!=='system'&&chat.$orig.type!=='template'}}"><view class="cu-info">{{chat.g3}}</view></block><block wx:if="{{chat.$orig.type!=='system'&&chat.$orig.type!=='template'}}"><view><view class="{{['cu-item',(chat.$orig.identify==='user')?'self':'']}}"><block wx:if="{{chat.$orig.identify!=='user'}}"><view class="cu-avatar round" style="{{('background-image:url('+(chat.$orig.server_avatar?chat.$orig.server_avatar:$IMG_URL+'/imgs/chat/default-chat-avatar.png')+')')}}"></view></block><view class="main"><block wx:if="{{chat.$orig.type==='text'}}"><view class="{{['content ',chat.$orig.identify!=='user'?'bg-white':' bg-gradual-purple']}}" style="max-width:480rpx;"><u-parse vue-id="{{'0dc13a66-4-'+index}}" html="{{chat.$orig.msg}}" bind:__l="__l"></u-parse></view></block><block wx:if="{{chat.$orig.type==='order'}}"><view data-event-opts="{{[['tap',[['jump',['/pages/order/detail',['o',['id',chat.$orig.msg.id]]]]]]]}}" class="content " bindtap="__e"><view class="order-chat"><view class="order-code u-m-b-20">{{"订单号："+chat.$orig.msg.order_sn}}</view><view class="goods-card u-flex u-col-center"><view class="img-wrap"><image class="goods-img" src="{{chat.$orig.msg.image}}" mode></image></view><view class="u-flex-col u-row-between card-right"><view class="goods-title u-ellipsis-2">{{chat.$orig.msg.title}}</view><view class="u-flex u-col-center price-box"><view class="goods-price">{{chat.$orig.msg.price}}</view><text class="goods-state u-m-l-10">{{chat.$orig.msg.status_name}}</text></view></view></view></view></view></block><block wx:if="{{chat.$orig.type==='goods'}}"><view data-event-opts="{{[['tap',[['jump',['/pages/goods/detail',['o',['id',chat.$orig.msg.id]]]]]]]}}" class="content " bindtap="__e"><view class="goods-card u-flex u-col-center"><view class="img-wrap"><image class="goods-img" src="{{chat.$orig.msg.image}}" mode></image></view><view class="u-flex-col u-row-between card-right"><view class="goods-title u-ellipsis-2">{{chat.$orig.msg.title}}</view><view class="u-flex u-row-between price-box"><view class="goods-price">{{chat.$orig.msg.price}}</view><text></text></view></view></view></view></block></view><block wx:if="{{chat.$orig.identify==='user'}}"><view class="cu-avatar round" style="{{('background-image:url('+userInfo.avatar+')')}}"></view></block></view></view></block><block wx:if="{{chat.$orig.type==='template'}}"><view class="template-box u-m-y-20"><view class="template-title">猜你想问</view><block wx:for="{{templateList}}" wx:for-item="item" wx:for-index="__i0__" wx:key="id"><view data-event-opts="{{[['tap',[['onQuestion',['$0'],[[['templateList','id',item.id]]]]]]]}}" class="template-item" bindtap="__e">{{"* "+item.title}}</view></block></view></block></block></block></view><view class="scroll-bottom" style="height:330rpx;" id="scrollBottom"></view></scroll-view><view class="cu-bar foot input u-flex-col"><view class="cu-bar u-flex-1" style="width:100%;"><view class="input-wrap u-flex-1 u-flex u-col-center u-m-r-20 u-p-l-20"><input class="input" placeholder-style="font-size:26rpx;color:#999" placeholder="请输入您想咨询的问题~" type="text" confirm-type="发送" focus="{{false}}" maxlength="300" cursor-spacing="10" data-event-opts="{{[['focus',[['InputFocus',['$event']]]],['blur',[['InputBlur',['$event']]]],['input',[['__set_model',['','msgText','$event',[]]],['onInput',['$event']]]],['confirm',[['onSend',['$event']]]]]}}" value="{{msgText}}" bindfocus="__e" bindblur="__e" bindinput="__e" bindconfirm="__e"/><view data-event-opts="{{[['tap',[['selEmoji',['$event']]]]]}}" class="action u-p-10" bindtap="__e"><text class="iconfont iconbiaoqing text-grey"></text></view></view><block wx:if="{{isFocus}}"><button data-event-opts="{{[['tap',[['onSend',['$event']]]]]}}" class="u-reset-button send-btn shadow" catchtap="__e">发送</button></block><block wx:else><button data-event-opts="{{[['tap',[['onTools',['$event']]]]]}}" class="u-reset-button more-btn" catchtap="__e"><view class="action" style="margin-right:0;"><text class="{{['iconfont icontianjia text-grey',(showTools)?'tools-active':'']}}"></text></view></button></block></view><block wx:if="{{showTools}}"><view class="tools-box u-flex" style="width:100%;"><u-upload class="u-flex-1 tools-item" vue-id="0dc13a66-5" showProgress="{{false}}" showUploadList="{{false}}" action="{{HTTP_API_URL+'/index/upload'}}" maxCount="9" customBtn="{{true}}" show-tips="{{false}}" data-event-opts="{{[['^onUploaded',[['uploadSuccess']]],['^onChange',[['uploadChange']]]]}}" bind:onUploaded="__e" bind:onChange="__e" bind:__l="__l" vue-slots="{{['addBtn']}}"><view class="tools-item u-flex-1" slot="addBtn"><image class="item-img" src="{{$IMG_URL+'/imgs/chat/imgs_icon.png'}}" mode></image><text class="item-title">图片</text></view></u-upload><view data-event-opts="{{[['tap',[['onToolItem',['goods']]]]]}}" class="tools-item u-flex-1" bindtap="__e"><image class="item-img" src="{{$IMG_URL+'/imgs/chat/goods_icon.png'}}" mode></image><text class="item-title">商品</text></view><view data-event-opts="{{[['tap',[['onToolItem',['order']]]]]}}" class="tools-item u-flex-1" bindtap="__e"><image class="item-img" src="{{$IMG_URL+'/imgs/chat/order_icon.png'}}" mode></image><text class="item-title">订单</text></view></view></block><block wx:if="{{showEmoji}}"><view class="emoji-box"><swiper class="emoji-swiper" indicator-dots="{{true}}" circular="{{true}}" indicator-active-color="#7063D2" indicator-color="rgba(235, 231, 255, 1)" autoplay="{{false}}" interval="{{3000}}" duration="{{1000}}"><block wx:for="{{newEmojiList}}" wx:for-item="memoji" wx:for-index="index" wx:key="index"><swiper-item><view class="swiper-item u-flex u-col-center"><block wx:for="{{memoji}}" wx:for-item="memo" wx:for-index="mindex" wx:key="file"><view data-event-opts="{{[['tap',[['onEmoji',['$0'],[[['newEmojiList','',index],['','file',memo.file]]]]]]]}}" class="emoji-img" bindtap="__e"><image class="emoji-img" src="{{EMOJI_BASE_URL+'/assets/addons/shopro/img/emoji/'+memo.file}}" mode></image></view></block></view></swiper-item></block></swiper></view></block></view><block wx:if="{{showLogBox}}"><view class="cu-bar log-box foot input u-flex-col"><view class="log-head u-flex u-row-between"><view class="title-box">{{logTitle}}</view><button data-event-opts="{{[['tap',[['closeToolsItem',['$event']]]]]}}" class="u-reset-button close-btn" bindtap="__e"><u-icon vue-id="0dc13a66-6" name="close-circle-fill" size="36" color="#e0e0e0" bind:__l="__l"></u-icon></button></view><view class="log-content"><scroll-view class="card-scroll-box" scroll-y="true" scroll-with-animation="{{true}}" show-scrollbar="{{false}}" data-event-opts="{{[['scrolltolower',[['loadMore',['$event']]]]]}}" bindscrolltolower="__e"><block wx:for="{{$root.l1}}" wx:for-item="item" wx:for-index="index" wx:key="index"><block wx:if="{{cardType==='order'}}"><view data-event-opts="{{[['tap',[['onOrderCard',['$0'],[[['orderList','',index]]]]]]]}}" class="log-item" bindtap="__e"><view class="code-box u-flex u-row-between"><view class="code-text">{{"订单号："+item.$orig.order_sn}}</view><view class="date-text">{{item.g4}}</view></view><view class="u-flex log-card"><view class="img-wrap"><image class="goods-img" src="{{item.$orig.item[0].goods_image}}" mode></image></view><view class="u-flex-col  card-right"><view class="goods-title u-ellipsis-2">{{item.$orig.item[0].goods_title}}</view><view class="num-box">{{"数量："+item.$orig.item[0].goods_num}}</view><view class="u-flex u-row-between price-box"><view class="goods-price">{{item.$orig.item[0].goods_price}}</view><text class="goods-state">{{item.$orig.status_name}}</text></view></view></view></view></block></block><block wx:for="{{viewList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><block wx:if="{{cardType==='goods'}}"><view data-event-opts="{{[['tap',[['onViewCard',['$0'],[[['viewList','',index]]]]]]]}}" class="log-item" bindtap="__e"><view class="u-flex log-card"><view class="img-wrap"><image class="goods-img" src="{{item.goods.image}}" mode></image></view><view class="u-flex-col u-row-between card-right"><view class="goods-title u-ellipsis-2">{{item.goods.title}}</view><view class="num-box">{{item.goods.subtitle}}</view><view class="u-flex u-row-between price-box"><view class="goods-price">{{item.goods.price}}</view><text class="goods-state"></text></view></view></view></view></block></block><u-loadmore vue-id="0dc13a66-7" height="80rpx" status="{{loadStatus}}" icon-type="flower" color="#ccc" bind:__l="__l"></u-loadmore></scroll-view></view></view></block><view data-event-opts="{{[['tap',[['onMask',['$event']]]]]}}" class="{{['cu-modal',(showTools||showEmoji)?'show':'']}}" style="z-index:1000;" bindtap="__e"></view><shopro-auth-modal vue-id="0dc13a66-8" bind:__l="__l"></shopro-auth-modal></view>