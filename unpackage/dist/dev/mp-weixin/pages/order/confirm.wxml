<view class="order-wrap"><block wx:if="{{orderPre.need_address}}"><view data-event-opts="{{[['tap',[['jump',['/pages/user/address1/list',['o',['from','order']]]]]]]}}" class="head_box" bindtap="__e"><block wx:if="{{!addressId}}"><view class="add-address-box u-flex u-flex-1"><view class="box-bg u-p-30 u-flex-1 u-flex u-row-between"><text class="select-notice">请选择取货地址</text><u-icon vue-id="7fdf8c20-1" name="arrow-right" size="28" color="#bfbfbf" bind:__l="__l"></u-icon></view></view></block><block wx:else><view class="add-address-box u-p-30"><view class="top u-flex"><text class="name">{{addressData.consignee}}</text><text class="phone">{{addressData.phone}}</text><text hidden="{{!(addressData.is_default==1)}}" class="tag">默认</text></view><view class="detail u-flex u-row-between"><view class="address">{{addressData.province_name+addressData.city_name+addressData.area_name+addressData.address}}</view><u-icon vue-id="7fdf8c20-2" name="arrow-right" size="28" color="#bfbfbf" bind:__l="__l"></u-icon></view></view></block></view></block><block wx:if="{{orderPre.need_address}}"><view data-event-opts="{{[['tap',[['jump',['/pages/user/address2/list',['o',['from','order']]]]]]]}}" class="head_box" bindtap="__e"><block wx:if="{{!addressId}}"><view class="add-address-box u-flex u-flex-1"><view class="box-bg u-p-30 u-flex-1 u-flex u-row-between"><text class="select-notice">请选择收货地址</text><u-icon vue-id="7fdf8c20-3" name="arrow-right" size="28" color="#bfbfbf" bind:__l="__l"></u-icon></view></view></block><block wx:else><view class="add-address-box u-p-30"><view class="top u-flex"><text class="name">{{addressData.consignee}}</text><text class="phone">{{addressData.phone}}</text><text hidden="{{!(addressData.is_default==1)}}" class="tag">默认</text></view><view class="detail u-flex u-row-between"><view class="address">{{addressData.province_name+addressData.city_name+addressData.area_name+addressData.address}}</view><u-icon vue-id="7fdf8c20-4" name="arrow-right" size="28" color="#bfbfbf" bind:__l="__l"></u-icon></view></view></block></view></block><view class="u-m-b-10"><block wx:for="{{perGoodsList}}" wx:for-item="g" wx:for-index="__i0__" wx:key="sku_price_id"><view class="goods-list"><view data-event-opts="{{[['tap',[['changeTime']]]]}}" class="logistic item-list u-flex u-row-between" bindtap="__e"><view class="item-title">骑手取单时间</view><view class="u-flex"><u-icon vue-id="{{'7fdf8c20-5-'+__i0__}}" name="arrow-right" size="28" color="#bfbfbf" bind:__l="__l"></u-icon></view></view></view></block><block wx:if="{{perGoodsList.length}}"><block><view class="remark-box u-flex item-list"><view class="item-title">备注</view><input class="item-input u-p-30" placeholder-class="input-pl" type="text" placeholder="需要备注的内容" data-event-opts="{{[['input',[['__set_model',['','remark','$event',[]]]]]]}}" value="{{remark}}" bindinput="__e"/></view><block wx:if="{{hasCoupons}}"><sh-select-coupon vue-id="7fdf8c20-6" couponList="{{couponList}}" data-event-opts="{{[['^change',[['selectCoupon']]]]}}" bind:change="__e" bind:__l="__l"></sh-select-coupon></block><view hidden="{{!(orderType==='score')}}" class="score item-list u-flex u-row-between"><view class="u-flex"><text class="item-title">积分</text></view><view class="price">{{"-"+(orderPre.score_amount||0)+"积分"}}</view></view><view class=" u-flex u-row-between item-list border-top u-m-b-10"><view class="item-title">商品金额</view><input class="item-input u-p-30" placeholder-class="input-pl" type="number" placeholder="填写金额" data-event-opts="{{[['input',[['__set_model',['','goods_money','$event',[]]]]]]}}" value="{{goods_money}}" bindinput="__e"/>元</view><view class=" u-flex u-row-between item-list border-top u-m-b-10"><view class="item-title">加急小费金额</view><input class="item-input u-p-30" placeholder-class="input-pl" type="number" placeholder="金额越大越快速接单" data-event-opts="{{[['input',[['__set_model',['','goods_money','$event',[]]]]]]}}" value="{{goods_money}}" bindinput="__e"/>元</view><block wx:if="{{orderPre.activity_discount_infos&&orderPre.activity_discount_infos.length&&$root.m0}}"><u-collapse vue-id="7fdf8c20-7" event-type="close" arrow="{{true}}" accordion="{{true}}" arrowColor="#bfbfbf" head-style="{{({background:'#fff',height:'100rpx'})}}" bind:__l="__l" vue-slots="{{['default']}}"><u-collapse-item vue-id="{{('7fdf8c20-8')+','+('7fdf8c20-7')}}" bind:__l="__l" vue-slots="{{['default','title']}}"><view slot="title"><view class="u-flex u-row-between item-list" style="width:680rpx;padding-right:0;"><view class="item-title">活动优惠</view><view class="u-flex"><text class="price" style="margin-right:0;">{{"-￥"+(orderPre.activity_discount_money||'0.00')}}</text></view></view></view><block wx:for="{{orderPre.activity_discount_infos}}" wx:for-item="item" wx:for-index="__i1__" wx:key="activity_id"><view><block wx:if="{{item.activity_type!=='free_shipping'}}"><view class="u-flex u-row-between item-list"><view class="item-title">{{item.activity_title}}</view><view class="u-flex"><text class="price" style="color:#666;">{{"-￥"+(item.activity_discount_money||'0.00')}}</text></view></view></block></view></block></u-collapse-item></u-collapse></block><view class="price-box  u-flex u-row-between item-list"><view class="item-title u-flex u-col-center"><view class="u-m-r-10">运费</view><block wx:if="{{$root.m1>0}}"><view class="activity-title">{{"活动减￥ "+orderPre.dispatch_discount_money}}</view></block></view><view class="u-flex"><block wx:if="{{$root.m2>0}}"><text class="origin-price u-m-r-10">{{"-￥"+orderPre.dispatch_amount}}</text></block><text class="price">{{"￥"+($root.m3-$root.m4||'0.00')}}</text></view></view><view class="price-box  u-flex u-row-between item-list"><view class="u-flex"><view class="all-money"><text>合计：</text><text class="price">{{"￥"+(orderPre.total_fee||'0.00')}}</text></view></view><u-button vue-id="7fdf8c20-9" shape="circle" disabled="{{isDisabled}}" loading="{{isDisabled}}" custom-style="{{customStyle}}" hair-line="{{false}}" hover-class="btn-hover" data-event-opts="{{[['^click',[['subOrder']]]]}}" bind:click="__e" bind:__l="__l" vue-slots="{{['default']}}">提交订单</u-button></view></block></block></view><view class="foot-box-wrap"><view class="foot-box u-flex u-row-between safe-area-inset-bottom"><view class="u-flex"><text class="num">{{"共"+totalNum+"件"}}</text><view class="all-money"><text>合计：</text><text class="price">{{"￥"+(orderPre.total_fee||'0.00')}}</text></view></view><u-button vue-id="7fdf8c20-10" shape="circle" disabled="{{isDisabled}}" loading="{{isDisabled}}" custom-style="{{customStyle}}" hair-line="{{false}}" hover-class="btn-hover" data-event-opts="{{[['^click',[['subOrder']]]]}}" bind:click="__e" bind:__l="__l" vue-slots="{{['default']}}">提交订单</u-button></view></view><shopro-auth-modal vue-id="7fdf8c20-11" bind:__l="__l"></shopro-auth-modal><u-popup vue-id="7fdf8c20-12" safe-area-inset-bottom="{{true}}" mode="bottom" closeable="{{false}}" border-radius="20" value="{{showExpressType}}" data-event-opts="{{[['^close',[['e0']]],['^input',[['__set_model',['','showExpressType','$event',[]]]]]]}}" bind:close="__e" bind:input="__e" bind:__l="__l" vue-slots="{{['default']}}"><view class="express-type page_box"><view class="express-type__head head-box u-flex u-col-center"><block wx:for="{{$root.l0}}" wx:for-item="nav" wx:for-index="index" wx:key="id"><block wx:if="{{nav.g0}}"><view data-event-opts="{{[['tap',[['changeExpressType',['$0'],[[['expressType','id',nav.$orig.id,'value']]]]]]]}}" class="express-type__head-nav u-flex u-col-center u-row-center" bindtap="__e"><text class="{{['head-nav__title',(expressTypeCur===nav.$orig.value)?'head-nav__title--active':'']}}">{{nav.$orig.title}}</text><view hidden="{{!(expressTypeCur===nav.$orig.value)}}" class="{{[expressClass]}}"></view></view></block></block></view><view class="express-type__content content_box"><block wx:if="{{!addressId&&expressTypeCur!=='selfetch'&&expressTypeCur!=='autosend'}}"><view data-event-opts="{{[['tap',[['jump',['/pages/user/address/list',['o',['from','order']]]]]]]}}" class="empty-address u-flex u-col-center" bindtap="__e">请选择收货地址<u-icon vue-id="{{('7fdf8c20-13')+','+('7fdf8c20-12')}}" name="arrow-right" size="28" color="#999" bind:__l="__l"></u-icon></view></block><block wx:if="{{expressTypeCur=='express'&&addressId}}"><view class="express-address"><view data-event-opts="{{[['tap',[['jump',['/pages/user/address/list',['o',['from','order']]]]]]]}}" class="express-top  u-flex u-row-between" bindtap="__e"><view><text hidden="{{!(addressData.is_default==1)}}" class="tag">默认</text><text class="address">{{addressData.province_name+addressData.city_name+addressData.area_name+addressData.address}}</text><text class="address-guide"><u-icon vue-id="{{('7fdf8c20-14')+','+('7fdf8c20-12')}}" name="arrow-right" size="28" color="#bfbfbf" bind:__l="__l"></u-icon></text></view><view class="address-location u-flex-col u-col-center"><image class="location-img" src="{{$IMG_URL+'/imgs/order/e0.png'}}" mode></image><text class="location-text">班车配送</text></view></view><view class="express-content"><view class="phone-box1"><text class="name">{{addressData.consignee}}</text><text class="phone">{{addressData.phone}}</text></view></view></view></block><block wx:if="{{expressTypeCur=='selfetch'}}"><view class="express-address"><block wx:if="{{!lat}}"><view class="u-flex-col u-col-center location-box"><image class="nolocation-img" src="{{$IMG_URL+'/imgs/order/location.png'}}" mode></image><text class="location-title">开启定位服务</text><text class="location-tip">为你推荐更精准的位置信息噢~</text><button data-event-opts="{{[['tap',[['getLocation',['$event']]]]]}}" class="u-reset-button open-location" bindtap="__e">去开启</button></view></block><block wx:else><view><view data-event-opts="{{[['tap',[['jump',['/pages/order/express/store-address',['o',['goodsId',currentGoodsId],['lat',lat],['lng',lng],['storeId',storeInfo?storeInfo.id:0]]]]]]]}}" class="express-top u-flex u-col-center u-row-between" bindtap="__e"><view><block wx:if="{{addressData.is_default==1}}"><text class="tag1">最近</text></block><text class="address">{{storeInfo?storeInfo.name:'暂无自提点'}}</text><u-icon vue-id="{{('7fdf8c20-15')+','+('7fdf8c20-12')}}" name="arrow-right" size="28" color="#999" bind:__l="__l"></u-icon></view><view class="address-location u-flex-col u-col-center"><image class="location-img" src="{{$IMG_URL+'/imgs/order/e1.png'}}" mode></image><view class="location-text">{{"距您"+(storeInfo?storeInfo.distance_text:0)}}</view></view></view><view class="express-content u-flex u-col-cetner"><view class="time-box"><view class="box-title u-m-b-20">到店时间</view><view data-event-opts="{{[['tap',[['checkExpressTime',['selfetch']]]]]}}" class="box-content u-flex u-col-center" bindtap="__e"><text class="box-text">{{checkTime['day'][checkDayCur].title+checkTime['time'][checkTimeCur]}}</text><u-icon vue-id="{{('7fdf8c20-16')+','+('7fdf8c20-12')}}" name="arrow-right" size="28" color="#999" bind:__l="__l"></u-icon></view></view><view class="box-line"></view><view class="phone-box"><view class="box-title u-m-b-20">预留电话</view><view class="box-content u-flex" style="width:340rpx;"><u-input bind:input="__e" vue-id="{{('7fdf8c20-17')+','+('7fdf8c20-12')}}" placeholder="请输入预留电话" placeholderStyle="font-size:24rpx" border="{{true}}" height="40" focus="{{getFocus}}" type="number" value="{{selfPhone}}" data-event-opts="{{[['^input',[['__set_model',['','selfPhone','$event',[]]]]]]}}" bind:__l="__l"></u-input></view></view></view><view data-event-opts="{{[['tap',[['checkProtocol',['$event']]]]]}}" class="express-bottom" bindtap="__e"><u-checkbox vue-id="{{('7fdf8c20-18')+','+('7fdf8c20-12')}}" active-color="#f0c785" value="{{isProtocol}}" bind:__l="__l" vue-slots="{{['default']}}"><view class="protocol">同意并接受<text data-event-opts="{{[['tap',[['jump',['/pages/public/richtext',['o',['id',storeTcp.selfetch_protocol]]]]]]]}}" class="protocol-text" catchtap="__e">《到店自提服务协议》</text></view></u-checkbox></view></view></block></view></block><block wx:if="{{expressTypeCur=='store'&&addressId}}"><view class="express-address"><view data-event-opts="{{[['tap',[['jump',['/pages/user/address/list',['o',['from','order']]]]]]]}}" class="express-top u-flex u-row-between" bindtap="__e"><view><block wx:if="{{addressData.is_default==1}}"><text class="tag">默认</text></block><text class="address">{{addressData.province_name+addressData.city_name+addressData.area_name+addressData.address}}</text><text class="address-guide"><u-icon vue-id="{{('7fdf8c20-19')+','+('7fdf8c20-12')}}" name="arrow-right" size="28" color="#999" bind:__l="__l"></u-icon></text></view><view class="address-location u-flex-col u-col-center"><image class="location-img" src="{{$IMG_URL+'/imgs/order/e2.png'}}" mode></image><text class="location-text">商家配送</text></view></view><view class="express-content u-flex"><view class="time-box"><view class="box-title u-m-b-20">配送时间</view><view data-event-opts="{{[['tap',[['checkExpressTime',['store']]]]]}}" class="box-content" bindtap="__e"><text class="box-text">{{checkTime['day'][checkDayCur].title+checkTime['time'][checkTimeCur]}}</text><u-icon vue-id="{{('7fdf8c20-20')+','+('7fdf8c20-12')}}" name="arrow-right" size="28" color="#999" bind:__l="__l"></u-icon></view></view><view class="box-line"></view><view class="phone-box"><view class="box-title u-m-b-20">预留电话</view><view class="box-content u-flex"><view class="box-content u-flex" style="width:340rpx;"><u-input bind:input="__e" vue-id="{{('7fdf8c20-21')+','+('7fdf8c20-12')}}" placeholder="请输入预留电话" placeholderStyle="font-size:24rpx" border="{{true}}" height="40" focus="{{getFocus}}" type="number" value="{{selfPhone}}" data-event-opts="{{[['^input',[['__set_model',['','selfPhone','$event',[]]]]]]}}" bind:__l="__l"></u-input></view></view></view></view></view></block><block wx:if="{{expressTypeCur=='autosend'}}"><view class="express-address"><view class="express-top u-flex u-row-between"><text class="dispatch-notice">订单支付完成后，请在订单详情页查看发货信息</text><view class="address-location u-flex-col u-col-center"><image class="location-img" src="{{$IMG_URL+'/imgs/order/e3.png'}}" mode></image><text class="location-text">自动发货</text></view></view></view></block></view><view hidden="{{!(expressTypeCur!=='selfetch'||expressTypeCur=='selfetch'&&lat)}}" class="express-type__bottom u-flex u-row-between u-p-b-20"><button data-event-opts="{{[['tap',[['hideExpressType',['$event']]]]]}}" class="u-reset-button cancel-btn" bindtap="__e">取消</button><button data-event-opts="{{[['tap',[['saveExpressType',['$event']]]]]}}" class="u-reset-button save-btn" bindtap="__e">确定</button></view></view></u-popup><u-popup bind:input="__e" vue-id="7fdf8c20-22" mode="bottom" safe-area-inset-bottom="{{true}}" closeable="{{true}}" close-icon-pos="top-right" border-radius="20" value="{{showCheckTime}}" data-event-opts="{{[['^input',[['__set_model',['','showCheckTime','$event',[]]]]]]}}" bind:__l="__l" vue-slots="{{['default']}}"><view class="checkTime-box page_box"><view class="checkTime-head">选择取单时间</view><view class="checkTime-content content_box u-flex"><view class="checkTime-content__left"><block wx:for="{{checkTime.day}}" wx:for-item="day" wx:for-index="index" wx:key="value"><view data-event-opts="{{[['tap',[['check',['day',index]]]]]}}" class="{{['left-item u-flex u-row-center u-col-center',(checkDayCur==index)?'item--active':'']}}" bindtap="__e">{{''+day.title+''}}</view></block></view><scroll-view class="checkTime-content__right scroll-box" scroll-into-view="{{'c'+checkTimeId}}" scroll-y="{{true}}" scroll-with-animation="{{true}}"><block wx:for="{{$root.l1}}" wx:for-item="time" wx:for-index="index" wx:key="$orig"><view class="{{['right-item',(checkTimeCur==index)?'item--active':'']}}" id="{{'c'+time.g1[0]}}" data-event-opts="{{[['tap',[['check',['time',index]]]]]}}" bindtap="__e">{{''+time.$orig+''}}</view></block></scroll-view></view><view class=" checkTime-foot u-flex u-row-center u-col-center"><button data-event-opts="{{[['tap',[['e1',['$event']]]]]}}" class="u-reset-button save-btn" bindtap="__e">保存并使用</button></view></view></u-popup></view>